<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    

<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Using SQLXML Objects (The Java&trade; Tutorials &gt;        
            JDBC(TM) Database Access &gt; JDBC Basics)
</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
     <meta name="description" content="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform transactions" />
     <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set" />
        
<style type="text/css">
    body {
        margin-left:10px;
        margin-right:10px;
        line-height: 1.5;
        FONT-FAMILY: Arial, Helvetica, sans-serif; 
        font-size: 0.8em;
    }
    
    a:link{text-decoration:none; color:#09569d;}
    a:visited{text-decoration:none; color: #3a87cf;}
    a:hover{text-decoration:underline; }
        
    code{
        font-family:Monaco,Courier,"Courier New";
    }
    
    .header-container {
        background-color: #fff;
        border-bottom: 1px solid #C1CFDA;
        -webkit-box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
        box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
    }
    
    .bookwrapper {
        width: auto;
        margin: auto;
    }
    
    .clearfix {
    }
    
    .clearfloat {
        clear: both;
        overflow: auto;
        height: 0px;
        font-size: 1px;
        line-height: 0px;
    }
    
    #brandProdName {
        width: auto;
        height: auto;
    }
    
    #logocover {
        display: block;
        background: transparent url(../../images/oracle-java-logo.png) 0px 0px no-repeat;
        height: 50px;
        width: 229px;
        float: left;
    }
    
    #productName {
        font-size: 16px;
        position: relative;
        top: 19px;
        padding-left: 3px;
        color: #457798;
        white-space: nowrap;
        width: 340px;
    }


    .FigureCaption   { 
        font-family: sans-serif; 
        text-align: center;
    }
    
    #TopBar_bl {        
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        margin-left: -110px;
        margin-right: -100px;       
		align: left;
        height: 60px;
    }
    #TopBar_tr {
        width: 100%;
        height: 60px;
    }
    
    #TopBar {
        min-width:700px;
        padding:25px 100px 10px;
        margin-bottom:25px;
        clear:both;
        
        border-bottom:1px solid #d2dde5;
        border-radius: 3px;
    
        background:#efefef; /* Old browsers */
        /* IE9 SVG, needs conditional override of 'filter' to 'none' */
        background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlMmVmZjkiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
        background: -moz-linear-gradient(top,  #ffffff 0%, #e2eff9 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e2eff9)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* IE10+ */
        background: linear-gradient(to bottom,  #ffffff 0%,#e2eff9 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e2eff9',GradientType=0 ); /* IE6-8 */
        
    }
    
    #TopBar_left {
        line-height: 14px;
        position: absolute;
        padding-top: 30px;
        padding-right: 30px;
        padding-left: 30px;
        text-align: left;
        font: 13px/20px Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 20px;
        color: #333;
    }
    
    #TopBar_right {
        line-height: 12px;
        float: right;
        padding-top: 10px;
        padding-right: 30px;
        text-align: left;
    }
    

    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    
     
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 10px;
        margin: 3px;
        padding: 0;
    }
 
    #BreadCrumbs {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    
    #BreadCrumbs a {
        color:#09569d;
    }
    
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }
    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    
    .LeftBar_shown {
        width: 13em;
        float: left;
    }
    
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    
    .LeftBar_hidden {
        display: none;
    }
    
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;       
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }

    .NavBit  {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    
    @media print {
        .NavBit {
            display: none;
        }
    }
    
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    
    #Contents a, .NavBit a, #TagNotes a {
        color:#09569d;
    }
    
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em;
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #333;
		
		
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
	
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #333;
        
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
		font-size:12px;
		font-family:Monaco,Courier,"Courier New";
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }
</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    </head>
<body onload="load()">
    <noscript>
        A browser with JavaScript enabled is required for this page to operate properly.
    </noscript>
        <!-- header -->
    <div class="header-container">
        <div class="bookwrapper  clearfix">       
            <div id="brandProdName">
                <div id="logocover"></div>
                <div id="productName" >Documentation</div>
            </div> 
            <br class="clearfloat" />
        </div>
    </div>
    
    <div id="TopBar">
     <div id="TopBar_tr"> <div id="TopBar_tl"> <div id="TopBar_br"> <div id="TopBar_bl"> 
                        <div id="TopBar_left">
                            The Java&trade; Tutorials
                        </div>
                        <div id="TopBar_right"> 
                            <a target="_blank"
				href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">Download Ebooks</a><br />
                            <a target="_blank"
                                href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Download JDK</a>
                            <br />
                            <a href="../../search.html" target="_blank">Search Java Tutorials</a>
                            <br />           
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>


    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">JDBC Basics</a></div>
<div class="linkAHEAD"><a href="gettingstarted.html">Getting Started</a></div>
<div class="linkAHEAD"><a href="processingsqlstatements.html">Processing SQL Statements with JDBC</a></div>
<div class="linkAHEAD"><a href="connecting.html">Establishing a Connection</a></div>
<div class="linkAHEAD"><a href="sqldatasources.html">Connecting with DataSource Objects</a></div>
<div class="linkAHEAD"><a href="sqlexception.html">Handling SQLExceptions</a></div>
<div class="linkAHEAD"><a href="tables.html">Setting Up Tables</a></div>
<div class="linkAHEAD"><a href="retrieving.html">Retrieving and Modifying Values from Result Sets</a></div>
<div class="linkAHEAD"><a href="prepared.html">Using Prepared Statements</a></div>
<div class="linkAHEAD"><a href="transactions.html">Using Transactions</a></div>
<div class="linkAHEAD"><a href="rowset.html">Using RowSet Objects</a></div>
<div class="linkAHEAD"><a href="jdbcrowset.html">Using JdbcRowSet Objects</a></div>
<div class="linkAHEAD"><a href="cachedrowset.html">Using CachedRowSetObjects</a></div>
<div class="linkAHEAD"><a href="joinrowset.html">Using JoinRowSet Objects</a></div>
<div class="linkAHEAD"><a href="filteredrowset.html">Using FilteredRowSet Objects</a></div>
<div class="linkAHEAD"><a href="webrowset.html">Using WebRowSet Objects</a></div>
<div class="linkAHEAD"><a href="sqltypes.html">Using Advanced Data Types</a></div>
<div class="linkAHEAD"><a href="blob.html">Using Large Objects</a></div>
<div class="nolinkAHEAD">Using SQLXML Objects</div>
<div class="linkAHEAD"><a href="array.html">Using Array Objects</a></div>
<div class="linkAHEAD"><a href="distinct.html">Using DISTINCT Data Type</a></div>
<div class="linkAHEAD"><a href="sqlstructured.html">Using Structured Objects</a></div>
<div class="linkAHEAD"><a href="sqlcustommapping.html">Using Customized Type Mappings</a></div>
<div class="linkAHEAD"><a href="sqldatalink.html">Using Datalink Objects</a></div>
<div class="linkAHEAD"><a href="sqlrowid.html">Using RowId Objects</a></div>
<div class="linkAHEAD"><a href="storedprocedures.html">Using Stored Procedures</a></div>
<div class="linkAHEAD"><a href="jdbcswing.html">Using JDBC with GUI API</a></div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
    <div class="PrintHeaders">
        <b>Trail:</b> JDBC(TM) Database Access
        <br /><b>Lesson:</b> JDBC Basics
    </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Home Page</a>
                &gt;
                <a href="../index.html" target="_top">JDBC(TM) Database Access</a>
                &gt;
                <a href="index.html" target="_top">JDBC Basics</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="blob.html">&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target="_top" href="../TOC.html">Trail</a>&nbsp;&bull;&nbsp;<a target="_top" href="array.html">Next&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle"><h1>Using SQLXML Objects</h1></div>
            <div id="PageContent">

<p>The <code>Connection</code> interface provides support for the creation of <code>SQLXML</code> objects using the method <code>createSQLXML</code>. The object that is created does not contain any data. Data may be added to the object by calling the <code>setString</code>, <code>setBinaryStream</code>, <code>setCharacterStream</code> or <code>setResult</code> method on the <code>SQLXML</code> interface.</p>
<p>The following topics are covered:</p>
<ul>
<li><a href="#creating_sqlxml">Creating SQLXML Objects</a></li>
<li><a href="#retrieving_sqlxml">Retrieving SQLXML Values in ResultSet</a></li>
<li><a href="#accessing_sqlxml">Accessing SQLXML Object Data</a></li>
<li><a href="#storing_sqlxml">Storing SQLXML Objects</a></li>
<li><a href="#initializing_sqlxml">Initializing SQLXML Objects</a></li>
<li><a href="#releasing_sqlxml">Releasing SQLXML Resources</a></li>
<li><a href="#sample_code">Sample Code</a></li>
</ul>
<h2><a name="creating_sqlxml" id="creating_sqlxml">Creating SQLXML Objects</a></h2>
<p>In the following excerpt, the method <code>Connection.createSQLXML</code> is used to create an empty <code>SQLXML</code> object. The <code>SQLXML.setString</code> method is used to write data to the <code>SQLXML</code> object that was created.</p>
<div class="codeblock"><pre>
Connection con = DriverManager.getConnection(url, props);
SQLXML xmlVal = con.createSQLXML();
xmlVal.setString(val);
</pre></div>

<h2><a name="retrieving_sqlxml" id="retrieving_sqlxml">Retrieving SQLXML Values in ResultSet</a></h2>

<p>The <code>SQLXML</code> data type is treated similarly to the more primitive built-in types. A <code>SQLXML</code> value can be retrieved by calling the <code>getSQLXML</code> method in the <code>ResultSet</code> or <code>CallableStatement</code> interface.</p>
<p>For example, the following excerpt retrieves a <code>SQLXML</code> value from the first column of the <code>ResultSet</code> <i>rs</i>:</p>
<div class="codeblock"><pre>
SQLXML xmlVar = rs.getSQLXML(1);
</pre></div>
<p><code>SQLXML</code> objects remain valid for at least the duration of the transaction in which they are created, unless their <code>free</code> method is invoked.</p>

<h2><a name="accessing_sqlxml" id="accessing_sqlxml">Accessing SQLXML Object Data</a></h2>

<p>The <code>SQLXML</code> interface provides the <code>getString</code>, <code>getBinaryStream</code>, <code>getCharacterStream</code>, and <code>getSource</code> methods to access its internal content. The following excerpt retrieves the contents of an <code>SQLXML</code> object using the <code>getString</code> method:</p>
<div class="codeblock"><pre>
SQLXML xmlVal= rs.getSQLXML(1);
String val = xmlVal.getString();
</pre></div>
<p>The <code>getBinaryStream</code> or <code>getCharacterStream</code> methods can be used to obtain an <code>InputStream</code> or a <code>Reader</code> object that can be passed directly to an XML parser. The following excerpt obtains an <code>InputStream</code> object from an <code>SQLXML</code> Object and then processes the stream using a DOM (Document Object Model) parser:</p>
<div class="codeblock"><pre>
SQLXML sqlxml = rs.getSQLXML(column);
InputStream binaryStream = sqlxml.getBinaryStream();
DocumentBuilder parser = 
    DocumentBuilderFactory.newInstance().newDocumentBuilder();
Document result = parser.parse(binaryStream);
</pre></div>
<p>The <code>getSource</code> method returns a <code>javax.xml.transform.Source</code> object. Sources are used as input to XML parsers and XSLT transformers.</p>
<p>The following excerpt retrieves and parses the data from a <code>SQLXML</code> object using the <code>SAXSource</code> object returned by invoking the <code>getSource</code> method:</p>
<div class="codeblock"><pre>
SQLXML xmlVal= rs.getSQLXML(1);
SAXSource saxSource = sqlxml.getSource(SAXSource.class);
XMLReader xmlReader = saxSource.getXMLReader();
xmlReader.setContentHandler(myHandler);
xmlReader.parse(saxSource.getInputSource());
</pre></div>
<h2><a name="storing_sqlxml" id="storing_sqlxml">Storing SQLXML Objects</a></h2>
<p>A <code>SQLXML</code> object can be passed as an input parameter to a <code>PreparedStatement</code> object just like other data types. The method <code>setSQLXML</code> sets the designated <code>PreparedStatement</code> parameter with a <code>SQLXML</code> object.</p>
<p>In the following excerpt, <code>authorData</code> is an instance of the <code>java.sql.SQLXML</code> interface whose data was initialized previously.</p>
<div class="codeblock"><pre>
PreparedStatement pstmt = conn.prepareStatement("INSERT INTO bio " +
                              "(xmlData, authId) VALUES (?, ?)");
pstmt.setSQLXML(1, authorData);
pstmt.setInt(2, authorId);
</pre></div>
<p>The <code>updateSQLXML</code> method can be used to update a column value in an updatable result set.</p>
<p>If the <code>java.xml.transform.Result</code>, <code>Writer</code>, or <code>OutputStream</code> object for the <code>SQLXML</code> object has not been closed prior to calling <code>setSQLXML</code> or <code>updateSQLXML</code>, a <code>SQLException</code> will be thrown.</p>
<h2><a name="initializing_sqlxml" id="initializing_sqlxml">Initializing SQLXML Objects</a></h2>
<p>The <code>SQLXML</code> interface provides the methods <code>setString</code>, <code>setBinaryStream</code>, <code>setCharacterStream</code>, or <code>setResult</code> to initialize the content for a <code>SQLXML</code> object that has been created by calling the <code>Connection.createSQLXML</code> method.</p>
<p>The following excerpt uses the method <code>setResult</code> to return a <code>SAXResult</code> object to populate a newly created <code>SQLXML</code> object:</p>
<div class="codeblock"><pre>
SQLXML sqlxml = con.createSQLXML();
SAXResult saxResult = sqlxml.setResult(SAXResult.class);
ContentHandler contentHandler = saxResult.getXMLReader().getContentHandler();
contentHandler.startDocument();
    
// set the XML elements and
// attributes into the result
contentHandler.endDocument();
</pre></div>
<p>The following excerpt uses the <code>setCharacterStream</code> method to obtain a <code>java.io.Writer</code> object in order to initialize a <code>SQLXML</code> object:</p>
<div class="codeblock"><pre>
SQLXML sqlxml = con.createSQLXML();
Writer out= sqlxml.setCharacterStream();
BufferedReader in = new BufferedReader(new FileReader("xml/foo.xml"));
String line = null;
while((line = in.readLine() != null) {
    out.write(line);
}
</pre></div>
<p>Similarly, the <code>SQLXML</code> <code>setString</code> method can be used to initialize a <code>SQLXML</code> object.</p>
<p>If an attempt is made to call the <code>setString</code>, <code>setBinaryStream</code>, <code>setCharacterStream</code>, and <code>setResult</code> methods on a <code>SQLXML</code> object that has previously been initialized, a <code>SQLException</code> will be thrown. If more than one call to the methods <code>setBinaryStream</code>, <code>setCharacterStream</code>, and <code>setResult</code> occurs for the same <code>SQLXML</code> object, a <code>SQLException</code> is thrown and the previously returned <code>javax.xml.transform.Result</code>, <code>Writer</code>, or <code>OutputStream</code> object is not affected.</p>
<h2><a name="releasing_sqlxml" id="releasing_sqlxml">Releasing SQLXML Resources</a></h2>
<p><code>SQLXML</code> objects remain valid for at least the duration of the transaction in which they are created. This could potentially result in an application running out of resources during a long running transaction. Applications may release <code>SQLXML</code> resources by invoking their <code>free</code> method.</p>
<p>In the following excerpt, the <code>method SQLXML.free</code> is called to release the resources held for a previously created <code>SQLXML</code> object.</p>
<div class="codeblock"><pre>
SQLXML xmlVar = con.createSQLXML();
xmlVar.setString(val);
xmlVar.free();
</pre></div>
<h2><a name="sample_code" id="sample_code">Sample Code</a></h2>
<p>MySQL and Java DB and their respective JDBC drivers do not fully support the <code>SQLXML</code> JDBC data type as described on in this section. However, the sample <code><a href="gettingstarted.html">RSSFeedsTable</a></code> demonstrates how to handle XML data with MySQL and Java DB.</p>
<p>The owner of The Coffee Break follows several RSS feeds from various web sites that cover restaurant and beverage industry news. An RSS (Really Simple Syndication or Rich Site Summary) feed is an XML document that contains a series of articles and associated metadata, such as the date of publication and author for each article. The owner would like to store these RSS feeds into a database table, including the RSS feed from The Coffee Break&#39;s blog.</p>
<p>The file <code><a href="gettingstarted.html">rss-the-coffee-break-blog.xml</a></code> is an example RSS feed from The Coffee Break&#39;s blog.</p>
<!-- ******************************** -->
<h3><a name="working-with-xml-data-in-mysql" id="working-with-xml-data-in-mysql">Working with XML Data in MySQL</a></h3>
<p>The sample <code>RSSFeedsTable</code> stores RSS feeds in the table <code>RSS_FEEDS</code>, which is created with the following command:</p>
<div class="codeblock"><pre>
create table RSS_FEEDS
    (RSS_NAME varchar(32) NOT NULL,
    RSS_FEED_XML longtext NOT NULL,
    PRIMARY KEY (RSS_NAME));
</pre></div>
<p>MySQL does not support the XML data type. Instead, this sample stores XML data in a column of type <code>LONGTEXT</code>, which is a <code>CLOB</code> SQL data type. MySQL has four <code>CLOB</code> data types; the <code>LONGTEXT</code> data type holds the greatest amount of characters among the four.</p>
<p>The method <code><a href="gettingstarted.html">RSSFeedsTable.addRSSFeed</a></code> adds an RSS feed to the <code>RSS_FEEDS</code> table. The first statements of this method converts the RSS feed (which is represented by an XML file in this sample) into an object of type <code>org.w3c.dom.Document</code>, which represents a DOM (Document Object Model) document. This class, along with classes and interfaces contained in the package <code>javax.xml</code>, contain methods that enable you to manipulate XML data content. For example, the following statement uses an XPath expression to retrieve the title of the RSS feed from the <code>Document</code> object:</p>
<div class="codeblock"><pre>
Node titleElement =
    (Node)xPath.evaluate("/rss/channel/title[1]",
        doc, XPathConstants.NODE);
</pre></div>
<p>The XPath expression <code>/rss/channel/title[1]</code> retrieves the contents of the first <code>&lt;title&gt;</code> element. For the file <code>rss-the-coffee-break-blog.xml</code>, this is the string <code>The Coffee Break Blog</code>.</p>
<p>The following statements add the RSS feed to the table <code>RSS_FEEDS</code>:</p>
<div class="codeblock"><pre>
// For databases that support the SQLXML
// data type, this creates a
// SQLXML object from
// org.w3c.dom.Document.

System.out.println("Adding XML file " + fileName);
String insertRowQuery =
    "insert into RSS_FEEDS " +
    "(RSS_NAME, RSS_FEED_XML) values " +
    "(?, ?)";
insertRow = con.prepareStatement(insertRowQuery);
insertRow.setString(1, titleString);

System.out.println("Creating SQLXML object with MySQL");
rssData = con.createSQLXML();
System.out.println("Creating DOMResult object");
DOMResult dom = (DOMResult)rssData.setResult(DOMResult.class);
dom.setNode(doc);

insertRow.setSQLXML(2, rssData);
System.out.println("Running executeUpdate()");
insertRow.executeUpdate();
</pre></div>
<p>The <code><a href="gettingstarted.html">RSSFeedsTable.viewTable</a></code> method retrieves the contents of <code>RSS_FEEDS</code>. For each row, the method creates an object of type <code>org.w3c.dom.Document</code> named <code>doc</code> in which to store the XML content in the column <code>RSS_FEED_XML</code>. The method retrieves the XML content and stores it in an object of type <code>SQLXML</code> named <code>rssFeedXML</code>. The contents of <code>rssFeedXML</code> are parsed and stored in the <code>doc</code> object.</p>
<!-- ************************************************* -->
<h3><a name="working-with-xml-data-in-java-db" id="working-with-xml-data-in-java-db">Working with XML Data in Java DB</a></h3>
<p><strong>Note</strong>: See the section &quot;XML data types and operators&quot; in <a href="http://docs.oracle.com/javadb/index_jdk8.html"><em>Java DB Developer&#39;s Guide</em></a> for more information about working with XML data in Java DB.</p>
<p>The sample <code>RSSFeedsTable</code> stores RSS feeds in the table <code>RSS_FEEDS</code>, which is created with the following command:</p>
<div class="codeblock"><pre>
create table RSS_FEEDS
    (RSS_NAME varchar(32) NOT NULL,
    RSS_FEED_XML xml NOT NULL,
    PRIMARY KEY (RSS_NAME));
</pre></div>
<p>Java DB supports the XML data type, but it does not support the <code>SQLXML</code> JDBC data type. Consequently, you must convert any XML data to a character format, and then use the Java DB operator <code>XMLPARSE</code> to convert it to the XML data type.</p>
<p>The <code><a href="gettingstarted.html">RSSFeedsTable.addRSSFeed</a></code> method adds an RSS feed to the <code>RSS_FEEDS</code> table. The first statements of this method convert the RSS feed (which is represented by an XML file in this sample) into an object of type <code>org.w3c.dom.Document</code>. This is described in the section <a href="#working-with-xml-data-in-mysql">Working with XML Data in MySQL</a>.</p>
<p>The <code><a href="gettingstarted.html">RSSFeedsTable.addRSSFeed</a></code> method converts the RSS feed to a <code>String</code> object with the method <code><a href="gettingstarted.html">JDBCTutorialUtilities.convertDocumentToString</a></code>.</p>
<p>Java DB has an operator named <code>XMLPARSE</code> that parses a character string representation into a Java DB XML value, which is demonstrated by the following excerpt:</p>
<div class="codeblock"><pre>
String insertRowQuery =
    "insert into RSS_FEEDS " +
    "(RSS_NAME, RSS_FEED_XML) values " +
    "(?, <strong>xmlparse(document cast " +
    "(? as clob) preserve whitespace)</strong>)";
</pre></div>
<p>The <code>XMLPARSE</code> operator requires that you convert the character representation of the XML document into a string data type that Java DB recognizes. In this example, it converts it into a <code>CLOB</code> data type. 
See <a href="gettingstarted.html">Getting Started</a> and the Java DB documentation for more information about Apache Xalan and Java DB requirements.</p>
<p>The method <code><a href="gettingstarted.html">RSSFeedsTable.viewTable</a></code> retrieves the contents of <code>RSS_FEEDS</code>. Because Java DB does not support the JDBC data type <code>SQLXML</code> you must retrieve the XML content as a string. Java DB has an operator named <code>XMLSERIALIZE</code> that converts an XML type to a character type:</p>
<div class="codeblock"><pre>
String query =
    "select RSS_NAME, " +
    "xmlserialize " +
    "(RSS_FEED_XML as clob) " +
    "from RSS_FEEDS";
</pre></div>
<p>As with the <code>XMLPARSE</code> operator, the <code>XMLSERIALIZE</code> operator requires that Apache Xalan be listed in your Java class path.</p>


        </div>
        <div class="NavBit">
            <a target="_top" href="blob.html">&laquo; Previous</a>
            &bull;
            <a target="_top" href="../TOC.html">Trail</a>
            &bull;
            <a target="_top" href="array.html">Next &raquo;</a>
        </div>
    </div>
    
<hr class="clearfloat"/>

<div id="Footer">
<table width="100%" border="0" cellspacing="0" cellpadding="5" summary="">
<tr>
    <td>
         <p class="footertext"><a name="license_info">Your use of this</a> page and all the material on pages under &quot;The Java Tutorials&quot; banner 
         is subject to these <a href="../../information/cpyr.html">legal notices</a>.
         </p>
         <p class="footertext">Copyright &copy; 1995, 2015 Oracle and/or its affiliates. All rights reserved.</p>
    </td>
    
    <td align="right">
        <p class="footertext">Problems with the examples? Try <a target="_blank"
        href="../../information/run-examples.html">Compiling and Running
        the Examples: FAQs</a>.
        </p>
        <p class="footertext">
        Complaints? Compliments? Suggestions? <a target="_blank"
            href="https://docs.oracle.com/javase/feedback.html">Give
        us your feedback</a>.       
        </p>
    </td>
    
</tr>
</table>
  
</div>
    
    <div class="PrintHeaders">
        <b>Previous page:</b> Using Large Objects
        <br /><b>Next page:</b> Using Array Objects
    </div>
</body>
</html> 
