<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    

<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Using Structured Objects (The Java&trade; Tutorials &gt;        
            JDBC(TM) Database Access &gt; JDBC Basics)
</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
     <meta name="description" content="This JDBC Java tutorial describes how to use JDBC API to create, insert into, update, and query tables. You will also learn how to use simple and prepared statements, stored procedures and perform transactions" />
     <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set" />
        
<style type="text/css">
    body {
        margin-left:10px;
        margin-right:10px;
        line-height: 1.5;
        FONT-FAMILY: Arial, Helvetica, sans-serif; 
        font-size: 0.8em;
    }
    
    a:link{text-decoration:none; color:#09569d;}
    a:visited{text-decoration:none; color: #3a87cf;}
    a:hover{text-decoration:underline; }
        
    code{
        font-family:Monaco,Courier,"Courier New";
    }
    
    .header-container {
        background-color: #fff;
        border-bottom: 1px solid #C1CFDA;
        -webkit-box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
        box-shadow: 0 2px 2px rgba(117, 163, 231, 0.1);
    }
    
    .bookwrapper {
        width: auto;
        margin: auto;
    }
    
    .clearfix {
    }
    
    .clearfloat {
        clear: both;
        overflow: auto;
        height: 0px;
        font-size: 1px;
        line-height: 0px;
    }
    
    #brandProdName {
        width: auto;
        height: auto;
    }
    
    #logocover {
        display: block;
        background: transparent url(../../images/oracle-java-logo.png) 0px 0px no-repeat;
        height: 50px;
        width: 229px;
        float: left;
    }
    
    #productName {
        font-size: 16px;
        position: relative;
        top: 19px;
        padding-left: 3px;
        color: #457798;
        white-space: nowrap;
        width: 340px;
    }


    .FigureCaption   { 
        font-family: sans-serif; 
        text-align: center;
    }
    
    #TopBar_bl {        
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        margin-left: -110px;
        margin-right: -100px;       
		align: left;
        height: 60px;
    }
    #TopBar_tr {
        width: 100%;
        height: 60px;
    }
    
    #TopBar {
        min-width:700px;
        padding:25px 100px 10px;
        margin-bottom:25px;
        clear:both;
        
        border-bottom:1px solid #d2dde5;
        border-radius: 3px;
    
        background:#efefef; /* Old browsers */
        /* IE9 SVG, needs conditional override of 'filter' to 'none' */
        background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlMmVmZjkiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
        background: -moz-linear-gradient(top,  #ffffff 0%, #e2eff9 100%); /* FF3.6+ */
        background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#e2eff9)); /* Chrome,Safari4+ */
        background: -webkit-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Chrome10+,Safari5.1+ */
        background: -o-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* Opera 11.10+ */
        background: -ms-linear-gradient(top,  #ffffff 0%,#e2eff9 100%); /* IE10+ */
        background: linear-gradient(to bottom,  #ffffff 0%,#e2eff9 100%); /* W3C */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#e2eff9',GradientType=0 ); /* IE6-8 */
        
    }
    
    #TopBar_left {
        line-height: 14px;
        position: absolute;
        padding-top: 30px;
        padding-right: 30px;
        padding-left: 30px;
        text-align: left;
        font: 13px/20px Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 20px;
        color: #333;
    }
    
    #TopBar_right {
        line-height: 12px;
        float: right;
        padding-top: 10px;
        padding-right: 30px;
        text-align: left;
    }
    

    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    
     
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 10px;
        margin: 3px;
        padding: 0;
    }
 
    #BreadCrumbs {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    
    #BreadCrumbs a {
        color:#09569d;
    }
    
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }
    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    
    .LeftBar_shown {
        width: 13em;
        float: left;
    }
    
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    
    .LeftBar_hidden {
        display: none;
    }
    
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;       
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }

    .NavBit  {
        padding: 15px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    
    @media print {
        .NavBit {
            display: none;
        }
    }
    
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    
    #Contents a, .NavBit a, #TagNotes a {
        color:#09569d;
    }
    
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em;
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #333;
		
		
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
	
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #333;
        
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
		font-size:12px;
		font-family:Monaco,Courier,"Courier New";
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }
</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    </head>
<body onload="load()">
    <noscript>
        A browser with JavaScript enabled is required for this page to operate properly.
    </noscript>
        <!-- header -->
    <div class="header-container">
        <div class="bookwrapper  clearfix">       
            <div id="brandProdName">
                <div id="logocover"></div>
                <div id="productName" >Documentation</div>
            </div> 
            <br class="clearfloat" />
        </div>
    </div>
    
    <div id="TopBar">
     <div id="TopBar_tr"> <div id="TopBar_tl"> <div id="TopBar_br"> <div id="TopBar_bl"> 
                        <div id="TopBar_left">
                            The Java&trade; Tutorials
                        </div>
                        <div id="TopBar_right"> 
                            <a target="_blank"
				href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">Download Ebooks</a><br />
                            <a target="_blank"
                                href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Download JDK</a>
                            <br />
                            <a href="../../search.html" target="_blank">Search Java Tutorials</a>
                            <br />           
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>


    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">JDBC Basics</a></div>
<div class="linkAHEAD"><a href="gettingstarted.html">Getting Started</a></div>
<div class="linkAHEAD"><a href="processingsqlstatements.html">Processing SQL Statements with JDBC</a></div>
<div class="linkAHEAD"><a href="connecting.html">Establishing a Connection</a></div>
<div class="linkAHEAD"><a href="sqldatasources.html">Connecting with DataSource Objects</a></div>
<div class="linkAHEAD"><a href="sqlexception.html">Handling SQLExceptions</a></div>
<div class="linkAHEAD"><a href="tables.html">Setting Up Tables</a></div>
<div class="linkAHEAD"><a href="retrieving.html">Retrieving and Modifying Values from Result Sets</a></div>
<div class="linkAHEAD"><a href="prepared.html">Using Prepared Statements</a></div>
<div class="linkAHEAD"><a href="transactions.html">Using Transactions</a></div>
<div class="linkAHEAD"><a href="rowset.html">Using RowSet Objects</a></div>
<div class="linkAHEAD"><a href="jdbcrowset.html">Using JdbcRowSet Objects</a></div>
<div class="linkAHEAD"><a href="cachedrowset.html">Using CachedRowSetObjects</a></div>
<div class="linkAHEAD"><a href="joinrowset.html">Using JoinRowSet Objects</a></div>
<div class="linkAHEAD"><a href="filteredrowset.html">Using FilteredRowSet Objects</a></div>
<div class="linkAHEAD"><a href="webrowset.html">Using WebRowSet Objects</a></div>
<div class="linkAHEAD"><a href="sqltypes.html">Using Advanced Data Types</a></div>
<div class="linkAHEAD"><a href="blob.html">Using Large Objects</a></div>
<div class="linkAHEAD"><a href="sqlxml.html">Using SQLXML Objects</a></div>
<div class="linkAHEAD"><a href="array.html">Using Array Objects</a></div>
<div class="linkAHEAD"><a href="distinct.html">Using DISTINCT Data Type</a></div>
<div class="nolinkAHEAD">Using Structured Objects</div>
<div class="linkAHEAD"><a href="sqlcustommapping.html">Using Customized Type Mappings</a></div>
<div class="linkAHEAD"><a href="sqldatalink.html">Using Datalink Objects</a></div>
<div class="linkAHEAD"><a href="sqlrowid.html">Using RowId Objects</a></div>
<div class="linkAHEAD"><a href="storedprocedures.html">Using Stored Procedures</a></div>
<div class="linkAHEAD"><a href="jdbcswing.html">Using JDBC with GUI API</a></div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
    <div class="PrintHeaders">
        <b>Trail:</b> JDBC(TM) Database Access
        <br /><b>Lesson:</b> JDBC Basics
    </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Home Page</a>
                &gt;
                <a href="../index.html" target="_top">JDBC(TM) Database Access</a>
                &gt;
                <a href="index.html" target="_top">JDBC Basics</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="distinct.html">&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target="_top" href="../TOC.html">Trail</a>&nbsp;&bull;&nbsp;<a target="_top" href="sqlcustommapping.html">Next&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle"><h1>Using Structured Objects</h1></div>
            <div id="PageContent">

<!-- Creating a SQL Structured Type -->
<p><strong>Note</strong>: MySQL and Java DB currently do not support user-defined types. Consequently, no JDBC tutorial example is available to demonstrate the features described in this section.</p>
<p>The following topics are covered:</p>
<ul>
<li><a href="#overview_structured">Overview of Structured Types</a></li>
<li><a href="#using_distinct_in_structured">Using DISTINCT Type in Structured Types</a></li>
<li><a href="#references_structured">Using References to Structured Types</a></li>
<li><a href="#code_ref">Sample Code for Creating SQL REF Object</a></li>
<li><a href="#udt_column_values">Using User-Defined Types as Column Values</a></li>
<li><a href="#insert_udt">Inserting User-Defined Types into Tables</a></li>
</ul>
<h2><a name="overview_structured" id="overview_structured">Overview of Structured Types</a></h2>
<p>SQL structured types and <code>DISTINCT</code> types are the two data types that a user can define in SQL. They are often referred to as UDTs (user-defined types), and you create them with a SQL <code>CREATE</code> <code>TYPE</code> statement.</p>
<p>Getting back to the example of The Coffee Break, suppose that the owner has been successful beyond all expectations and has been expanding with new branches. The owner has decided to add a <code>STORES</code> table to the database containing information about each establishment. <code>STORES</code> will have four columns:</p>
<ul>
<li><code>STORE_NO</code> for each store&#39;s identification number</li>
<li><code>LOCATION</code> for its address</li>
<li><code>COF_TYPES</code> for the coffees it sells</li>
<li><code>MGR</code> for the name of the store manager</li>
</ul>
<p>The owner makes the column <code>LOCATION</code> be a SQL structured type, the column <code>COF_TYPES</code> a SQL <code>ARRAY</code>, and the column <code>MGR</code> a <code>REF(MANAGER)</code>, with <code>MANAGER</code> being a SQL structured type.</p>
<p>The first thing the owner must define the new structured types for the address and the manager. A SQL structured type is similar to structured types in the Java programming language in that it has members, called <em>attributes</em>, that may be any data type. The owner writes the following SQL statement to create the new data type <code>ADDRESS</code>:</p>
<div class="codeblock"><pre>
CREATE TYPE ADDRESS
(
    NUM INTEGER,
    STREET VARCHAR(40),
    CITY VARCHAR(40),
    STATE CHAR(2),
    ZIP CHAR(5)
);
</pre></div>
<p>In this statement, the new type <code>ADDRESS</code> has five attributes, which are analogous to fields in a Java class. The attribute <code>NUM</code> is an <code>INTEGER</code>, the attribute <code>STREET</code> is a <code>VARCHAR(40)</code>, the attribute <code>CITY</code> is a <code>VARCHAR(40)</code>, the attribute <code>STATE</code> is a <code>CHAR(2)</code>, and the attribute <code>ZIP</code> is a <code>CHAR(5)</code>.</p>
<p>The following excerpt, in which <code>con</code> is a valid <code>Connection</code> object, sends the definition of <code>ADDRESS</code> to the database:</p>
<div class="codeblock"><pre>
String createAddress =
    "CREATE TYPE ADDRESS " +
    "(NUM INTEGER, STREET VARCHAR(40), " +
    "CITY VARCHAR(40), STATE CHAR(2), ZIP CHAR(5))";
Statement stmt = con.createStatement();
stmt.executeUpdate(createAddress);
</pre></div>
<p>Now the <code>ADDRESS</code> structured type is registered with the database as a data type, and the owner can use it as the data type for a table column or an attribute of a structured type.</p>
<!-- ************************************************** -->
<h2><a name="using_distinct_in_structured" id="using_distinct_in_structured">Using DISTINCT Type in Structured Type</a></h2>
<p>One of the attributes the owner of The Coffee Break plans to include in the new structured type <code>MANAGER</code> is the manager&#39;s telephone number. Because the owner will always list the telephone number as a 10-digit number (to be sure it includes the area code) and will never manipulate it as a number, the owner decides to define a new type called <code>PHONE_NO</code> that consists of 10 characters. The SQL definition of this data type, which can be thought of as a structured type with only one attribute, looks like this:</p>

<div class="codeblock"><pre>
CREATE TYPE PHONE_NO AS CHAR(10);
</pre></div>

<p>Or, as noted earlier, for some drivers the definition might look like this:</p>

<div class="codeblock"><pre>
CREATE DISTINCT TYPE PHONE_NO AS CHAR(10);
</pre></div>

<p>A <code>DISTINCT</code> type is always based on another data type, which must be a predefined type. In other words, a <code>DISTINCT</code> type cannot be based on a user-defined type (UDT). To retrieve or set a value that is a <code>DISTINCT</code> type, use the appropriate method for the underlying type (the type on which it is based). For example, to retrieve an instance of <code>PHONE_NO</code>, which is based on a <code>CHAR</code> type, you would use the method <code>getString</code> because that is the method for retrieving a <code>CHAR</code>.</p>
<p>Assuming that a value of type <code>PHONE_NO</code> is in the fourth column of the current row of the <code>ResultSet</code> object <code><em>rs</em></code>, the following line of code retrieves it:</p>

<div class="codeblock"><pre>
String phoneNumber = rs.getString(4);
</pre></div>

<p>Similarly, the following line of code sets an input parameter that has type <code>PHONE_NO</code> for a prepared statement being sent to the database:</p>

<div class="codeblock"><pre>
pstmt.setString(1, phoneNumber);
</pre></div>

<p>Adding on to the previous code fragment, the definition of <code>PHONE_NO</code> will be sent to the database with the following line of code:</p>

<div class="codeblock"><pre>
stmt.executeUpdate(
    "CREATE TYPE PHONE_NO AS CHAR(10)");
</pre></div>

<p>After registering the type <code>PHONE_NO</code> with the database, the owner can use it as a column type in a table or as the data type for an attribute in a structured type. The definition of <code>MANAGER</code> in the following SQL statement uses <code>PHONE_NO</code> as the data type for the attribute <code>PHONE</code>:</p>

<div class="codeblock"><pre>
CREATE TYPE MANAGER
(
    MGR_ID INTEGER,
    LAST_NAME VARCHAR(40),
    FIRST_NAME VARCHAR(40),
    PHONE PHONE_NO
);
</pre></div>

<p>Reusing <code><em>stmt</em></code>, defined previously, the following code fragment sends the definition of the structured type <code>MANAGER</code> to the database:</p>

<div class="codeblock"><pre>
  String createManager =
    "CREATE TYPE MANAGER " +
    "(MGR_ID INTEGER, LAST_NAME " +
    "VARCHAR(40), " +
    "FIRST_NAME VARCHAR(40), " +
    "PHONE PHONE_NO)";
  stmt.executeUpdate(createManager);
</pre></div>
<!-- ************************************** -->
<h2><a name="references_structured" id="references_structured">Using References to Structured Types</a></h2>
<p>The owner of The Coffee Break has created three new data types used as column types or attribute types in the database: The structured types <code>LOCATION</code> and <code>MANAGER</code>, and the <code>DISTINCT</code> type <code>PHONE_NO</code>. The entrepreneur has used <code>PHONE_NO</code> as the type for the attribute <code>PHONE</code> in the new type <code>MANAGER</code>, and <code>ADDRESS</code> as the data type for the column <code>LOCATION</code> in the table <code>STORES</code>. The <code>MANAGER</code> type could be used as the type for the column <code>MGR</code>, but instead the entrepreneur prefers to use the type <code>REF(MANAGER)</code> because the entrepreneur often has one person manage two or three stores. Using <code>REF(MANAGER)</code> as a column type avoids repeating all the data for <code>MANAGER</code> when one person manages more than one store.</p>
<p>With the structured type <code>MANAGER</code> already created, the owner can now create a table containing instances of <code>MANAGER</code> that can be referenced. A reference to an instance of <code>MANAGER</code> will have the type <code>REF(MANAGER)</code>. A SQL <code>REF</code> is nothing more than a logical pointer to a structured type, so an instance of <code>REF(MANAGER)</code> serves as a logical pointer to an instance of <code>MANAGER</code>.</p>
<p>Because a SQL <code>REF</code> value needs to be permanently associated with the instance of the structured type that it references, it is stored in a special table together with its associated instance. A programmer does not create <code>REF</code> types directly but rather creates the table that will store instances of a particular structured type that can be referenced. Every structured type that is to be referenced will have its own table. When you insert an instance of the structured type into the table, the database automatically creates a <code>REF</code> instance. For example, to contain instances of <code>MANAGER</code> that can be referenced, the owner created the following special table using SQL:</p>
<div class="codeblock"><pre>
  CREATE TABLE MANAGERS OF MANAGER
  (OID REF(MANAGER)
  VALUES ARE SYSTEM GENERATED);
</pre></div>
<p>This statement creates a table with the special column <code>OID</code>, which stores values of type <code>REF(MANAGER)</code>. Each time an instance of <code>MANAGER</code> is inserted into the table, the database will generate an instance of <code>REF(MANAGER)</code> and store it in the column <code>OID</code>. Implicitly, an additional column stores each attribute of <code>MANAGER</code> that has been inserted into the table, as well. For example, the following code fragment shows how the entrepreneur created three instances of the <code>MANAGER</code> structured type to represent three managers:</p>

<div class="codeblock"><pre>
  INSERT INTO MANAGERS (
    MGR_ID, LAST_NAME,
    FIRST_NAME, PHONE) VALUES
  (
    000001,
    'MONTOYA',
    'ALFREDO',
    '8317225600'
  );

  INSERT INTO MANAGERS (
    MGR_ID, LAST_NAME,
    FIRST_NAME, PHONE) VALUES
  (
    000002,
    'HASKINS',
    'MARGARET',
    '4084355600'
  );

  INSERT INTO MANAGERS (
    MGR_ID, LAST_NAME,
    FIRST_NAME, PHONE) VALUES
  (
    000003,
    'CHEN',
    'HELEN',
    '4153785600'
   );
</pre></div>

<p>The table <code>MANAGERS</code> will now have three rows, one row for each manager inserted so far. The column <code>OID</code> will contain three unique object identifiers of type <code>REF(MANAGER)</code>, one for each instance of <code>MANAGER.</code> These object identifiers were generated automatically by the database and will be permanently stored in the table <code>MANAGERS</code>. Implicitly, an additional column stores each attribute of <code>MANAGER</code>. For example, in the table <code>MANAGERS</code>, one row contains a <code>REF(MANAGER)</code> that references Alfredo Montoya, another row contains a <code>REF(MANAGER)</code> that references Margaret Haskins, and a third row contains a <code>REF(MANAGER)</code> that references Helen Chen.</p>
<p>To access a <code>REF(MANAGER)</code> instance, you select it from its table. For example, the owner retrieved the reference to Alfredo Montoya, whose ID number is 000001, with the following code fragment:</p>
<div class="codeblock"><pre>
  String selectMgr =
    "SELECT OID FROM MANAGERS " +
    "WHERE MGR_ID = 000001";
  ResultSet rs = stmt.executeQuery(selectMgr);
  rs.next();
  Ref manager = rs.getRef("OID");
</pre></div>
<p>Now the variable <code><em>manager</em></code> can be used as a column value that references Alfredo Montoya.</p>
<!-- ************************************** -->
<h2><a name="code_ref" id="code_ref">Sample Code for Creating SQL REF Object</a></h2>
<p>The following code example creates the table <code>MANAGERS</code>, a table of instances of the structured type <code>MANAGER</code> that can be referenced, and inserts three instances of <code>MANAGER</code> into the table. The column <code>OID</code> in this table will store instances of <code>REF(MANAGER)</code>. After this code is executed, the <code>MANAGERS</code> table will have a row for each of the three <code>MANAGER</code> objects inserted, and the value in the <code>OID</code> column will be the <code>REF(MANAGER)</code> type that identifies the instance of <code>MANAGER</code> stored in that row.</p>
<div class="codeblock"><pre>
package com.oracle.tutorial.jdbc;

import java.sql.*;

public class CreateRef {

    public static void main(String args[]) {

        JDBCTutorialUtilities myJDBCTutorialUtilities;
        Connection myConnection = null;

        if (args[0] == null) {
            System.err.println("Properties file not specified " +
                               "at command line");
            return;
        } else {
            try {
                myJDBCTutorialUtilities = new JDBCTutorialUtilities(args[0]);
            } catch (Exception e) {
                System.err.println("Problem reading properties " +
                                   "file " + args[0]);
                e.printStackTrace();
                return;
            }
        }

        Connection con = null;
        Statement stmt = null;

        try {
            String createManagers =
                "CREATE TABLE " +
                "MANAGERS OF MANAGER " +
                "(OID REF(MANAGER) " +
                "VALUES ARE SYSTEM " +
                "GENERATED)";

            String insertManager1 =
                "INSERT INTO MANAGERS " +
                "(MGR_ID, LAST_NAME, " +
                "FIRST_NAME, PHONE) " +
                "VALUES " +
                "(000001, 'MONTOYA', " +
                "'ALFREDO', " +
                "'8317225600')";

            String insertManager2 =
                "INSERT INTO MANAGERS " +
                "(MGR_ID, LAST_NAME, " +
                "FIRST_NAME, PHONE) " +
                "VALUES " +
                "(000002, 'HASKINS', " +
                "'MARGARET', " +
                "'4084355600')";

            String insertManager3 =
                "INSERT INTO MANAGERS " +
                "(MGR_ID, LAST_NAME, " +
                "FIRST_NAME, PHONE) " +
                "VALUES " +
                "(000003, 'CHEN', 'HELEN', " +
                "'4153785600')";
  
            con = myJDBCTutorialUtilities.getConnection();
            con.setAutoCommit(false);

            stmt = con.createStatement();
            stmt.executeUpdate(createManagers);

            stmt.addBatch(insertManager1);
            stmt.addBatch(insertManager2);
            stmt.addBatch(insertManager3);
            int [] updateCounts = stmt.executeBatch();

            con.commit();

            System.out.println("Update count for:  ");
            for (int i = 0; i &lt; updateCounts.length; i++) {
                System.out.print("    command " + (i + 1) + " = ");
                System.out.println(updateCounts[i]);
            }
        } catch(BatchUpdateException b) {
            System.err.println("-----BatchUpdateException-----");
            System.err.println("Message:  " + b.getMessage());
            System.err.println("SQLState:  " + b.getSQLState());
            System.err.println("Vendor:  " + b.getErrorCode());
            System.err.print("Update counts for " + "successful commands:  ");
            int [] rowsUpdated = b.getUpdateCounts();
            for (int i = 0; i &lt; rowsUpdated.length; i++) {
                System.err.print(rowsUpdated[i] + "   ");
            }
            System.err.println("");
        } catch(SQLException ex) {
            System.err.println("------SQLException------");
            System.err.println("Error message:  " + ex.getMessage());
            System.err.println("SQLState:  " + ex.getSQLState());
            System.err.println("Vendor:  " + ex.getErrorCode());
        } finally {
            if (stmt != null) { stmt.close(); }
              JDBCTutorialUtilities.closeConnection(con);
        }
    }
}
</pre></div>
<!-- ************************************** -->
<h2><a name="udt_column_values" id="udt_column_values">Using User-Defined Types as Column Values</a></h2>
<p>Our entrepreneur now has the UDTs required to create the table <code>STORES</code>. The structured type <code>ADDRESS</code> is the type for the column <code>LOCATION</code>, and the type <code>REF(MANAGER)</code> is the type for the column <code>MGR</code>.</p>
<p>The UDT <code>COF_TYPES</code> is based on the SQL data type <code>ARRAY</code> and is the type for the column <code>COF_TYPES</code>. The following line of code creates the type <code>COF_ARRAY</code> as an <code>ARRAY</code> value with 10 elements. The base type of <code>COF_ARRAY</code> is <code>VARCHAR(40)</code>.</p>
<div class="codeblock"><pre>
  CREATE TYPE COF_ARRAY AS ARRAY(10) OF VARCHAR(40);
</pre></div>
<p>With the new data types defined, the following SQL statement creates the table <code>STORES</code>:</p>

<div class="codeblock"><pre>
  CREATE TABLE STORES
  (
    STORE_NO INTEGER,
    LOCATION ADDRESS,
    COF_TYPES COF_ARRAY,
    MGR REF(MANAGER)
  );
</pre></div>

<!-- ************************************** -->
<h2><a name="insert_udt" id="insert_udt">Inserting User-Defined Types into Tables</a></h2>
<p>The following code fragment inserts one row into the <code>STORES</code> table, supplying values for the columns <code>STORE_NO</code>, <code>LOCATION</code>, <code>COF_TYPES</code>, and <code>MGR</code>, in that order:</p>

<div class="codeblock"><pre>
  INSERT INTO STORES VALUES
  (
    100001,
    ADDRESS(888, 'Main_Street',
      'Rancho_Alegre',
      'CA', '94049'),
    COF_ARRAY('Colombian', 'French_Roast',
      'Espresso', 'Colombian_Decaf',
      'French_Roast_Decaf'),
    SELECT OID FROM MANAGERS
      WHERE MGR_ID = 000001
  );
</pre></div>

<p>The following goes through each column and the value inserted into it.</p>

<div class="codeblock"><pre>
  STORE_NO: 100001
</pre></div>

<p>This column is type <code>INTEGER</code>, and the number <code>100001</code> is an <code>INTEGER</code> type, similar to entries made before in the tables <code>COFFEES</code> and <code>SUPPLIERS</code>.</p>
<div class="codeblock"><pre>
  LOCATION: ADDRESS(888, 'Main_Street',
    'Rancho_Alegre', 'CA', '94049')
</pre></div>
<p>The type for this column is the structured type <code>ADDRESS</code>, and this value is the constructor for an instance of <code>ADDRESS</code>. When we sent the definition of <code>ADDRESS</code> was sent to the database, one of the things it did was to create a constructor for the new type. The comma-separated values in parentheses are the initialization values for the attributes of the <code>ADDRESS</code> type, and they must appear in the same order in which the attributes were listed in the definition of the <code>ADDRESS</code> type. <code>888</code> is the value for the attribute <code>NUM</code>, which is an <code>INTEGER</code> value. <code>"Main_Street"</code> is the value for <code>STREET</code>, and <code>"Rancho_Alegre"</code> is the value for <code>CITY</code>, with both attributes being of type <code>VARCHAR(40)</code>. The value for the attribute <code>STATE</code> is <code>"CA"</code>, which is of type <code>CHAR(2)</code>, and the value for the attribute <code>ZIP</code> is <code>"94049"</code>, which is of type <code>CHAR(5)</code>.</p>

<div class="codeblock"><pre>
  COF_TYPES: COF_ARRAY(
    'Colombian',
    'French_Roast',
    'Espresso',
    'Colombian_Decaf',
    'French_Roast_Decaf'),
</pre></div>

<p>The column <code>COF_TYPES</code> is of type <code>COF_ARRAY</code> with a base type of <code>VARCHAR(40)</code>, and the comma-separated values between parentheses are the <code>String</code> objects that are the array elements. The owner defined the type <code>COF_ARRAY</code> as having a maximum of 10 elements. This array has 5 elements because the entrepreneur supplied only 5 <code>String</code> objects for it.</p>

<div class="codeblock"><pre>
  MGR: SELECT OID FROM MANAGERS
    WHERE MGR_ID = 000001
</pre></div>

<p>The column <code>MGR</code> is type <code>REF(MANAGER)</code>, which means that a value in this column must be a reference to the structured type <code>MANAGER</code>. All of the instances of <code>MANAGER</code> are stored in the table <code>MANAGERS</code>. All of the instances of <code>REF(MANAGER)</code> are also stored in this table, in the column <code>OID</code>. The manager for the store described in this table row is Alfredo Montoya, and his information is stored in the instance of <code>MANAGER</code> that has <code>100001</code> for the attribute <code>MGR_ID</code>. To get the <code>REF(MANAGER)</code> instance associated with the <code>MANAGER</code> object for Alfredo Montoya, select the column <code>OID</code> that is in the row where <code>MGR_ID</code> is <code>100001</code> in the table <code>MANAGERS</code>. The value that will be stored in the <code>MGR</code> column of the <code>STORES</code> table (the <code>REF(MANAGER)</code> value) is the value the DBMS generated to uniquely identify this instance of the <code>MANAGER</code> structured type.</p>
<p>Send the preceding SQL statement to the database with the following code fragment:</p>

<div class="codeblock"><pre>
  String insertMgr =
    "INSERT INTO STORES VALUES " +
    "(100001, " +
    "ADDRESS(888, 'Main_Street', " +
      "'Rancho_Alegre', 'CA', " +
      "'94049'), " +
    "COF_ARRAY('Colombian', " +
      "'French_Roast', 'Espresso', " +
      "'Colombian_Decaf', " +
      "'French_Roast_Decaf'}, " +
    "SELECT OID FROM MANAGERS " +
    "WHERE MGR_ID = 000001)";

  stmt.executeUpdate(insertMgr);
</pre></div>

<p>However, because you are going to send several <code>INSERT INTO</code> statements, it will be more efficient to send them all together as a batch update, as in the following code example:</p>
<div class="codeblock"><pre>
package com.oracle.tutorial.jdbc;

import java.sql.*;

public class InsertStores {
    public static void main(String args[]) {

        JDBCTutorialUtilities myJDBCTutorialUtilities;
        Connection myConnection = null;

        if (args[0] == null) {
            System.err.println(
                "Properties file " +
                "not specified " +
                "at command line");
            return;
        } else {
            try {
                myJDBCTutorialUtilities = new
                    JDBCTutorialUtilities(args[0]);
            } catch (Exception e) {
                System.err.println(
                    "Problem reading " +
                    "properties file " +
                    args[0]);
                e.printStackTrace();
                return;
            }
        }

        Connection con = null;
        Statement stmt = null;

        try {
            con = myJDBCTutorialUtilities.getConnection();
            con.setAutoCommit(false);

            stmt = con.createStatement();

            String insertStore1 =
                "INSERT INTO STORES VALUES (" +
                "100001, " +
                "ADDRESS(888, 'Main_Street', " +
                    "'Rancho_Alegre', 'CA', " +
                    "'94049'), " +
                "COF_ARRAY('Colombian', " +
                    "'French_Roast', " +
                    "'Espresso', " +
                    "'Colombian_Decaf', " +
                    "'French_Roast_Decaf'), " +
                "(SELECT OID FROM MANAGERS " +
                "WHERE MGR_ID = 000001))";

            stmt.addBatch(insertStore1);

            String insertStore2 =
                "INSERT INTO STORES VALUES (" +
                "100002, " +
                "ADDRESS(1560, 'Alder', " +
                    "'Ochos_Pinos', " +
                    "'CA', '94049'), " +
                "COF_ARRAY('Colombian', " +
                    "'French_Roast', " +
                    "'Espresso', " +
                    "'Colombian_Decaf', " +
                    "'French_Roast_Decaf', " +
                    "'Kona', 'Kona_Decaf'), " +
                "(SELECT OID FROM MANAGERS " +
                "WHERE MGR_ID = 000001))";

            stmt.addBatch(insertStore2);

            String insertStore3 =
                "INSERT INTO STORES VALUES (" +
                "100003, " +
                "ADDRESS(4344, " +
                    "'First_Street', " +
                    "'Verona', " +
                    "'CA', '94545'), " +
                "COF_ARRAY('Colombian', " +
                    "'French_Roast', " +
                    "'Espresso', " +
                    "'Colombian_Decaf', " +
                    "'French_Roast_Decaf', " +
                    "'Kona', 'Kona_Decaf'), " +
                "(SELECT OID FROM MANAGERS " +
                "WHERE MGR_ID = 000002))";

            stmt.addBatch(insertStore3);

            String insertStore4 =
                "INSERT INTO STORES VALUES (" +
                "100004, " +
                "ADDRESS(321, 'Sandy_Way', " +
                    "'La_Playa', " +
                    "'CA', '94544'), " +
                "COF_ARRAY('Colombian', " +
                    "'French_Roast', " +
                    "'Espresso', " +
                    "'Colombian_Decaf', " +
                    "'French_Roast_Decaf', " +
                    "'Kona', 'Kona_Decaf'), " +
                "(SELECT OID FROM MANAGERS " +
                "WHERE MGR_ID = 000002))";

            stmt.addBatch(insertStore4);

            String insertStore5 =
                "INSERT INTO STORES VALUES (" +
                "100005, " +
                "ADDRESS(1000, 'Clover_Road', " +
                    "'Happyville', " +
                    "'CA', '90566'), " +
                "COF_ARRAY('Colombian', " +
                    "'French_Roast', " +
                    "'Espresso', " + 
                    "'Colombian_Decaf', " +
                    "'French_Roast_Decaf'), " +
                "(SELECT OID FROM MANAGERS " +
                "WHERE MGR_ID = 000003))";

            stmt.addBatch(insertStore5);

            int [] updateCounts = stmt.executeBatch();

            ResultSet rs = stmt.executeQuery(
                "SELECT * FROM STORES");
            System.out.println("Table STORES after insertion:");
            System.out.println("STORE_NO   " + "LOCATION   " +
                "COF_TYPE   " + "MGR");

            while (rs.next()) {
                int storeNo = rs.getInt("STORE_NO");
                Struct location = (Struct)rs.getObject("LOCATION");
                Object[] locAttrs = location.getAttributes();
                Array coffeeTypes = rs.getArray("COF_TYPE");
                String[] cofTypes = (String[])coffeeTypes.getArray();

                Ref managerRef = rs.getRef("MGR");
                PreparedStatement pstmt = con.prepareStatement(
                    "SELECT MANAGER " +
                    "FROM MANAGERS " +
                    "WHERE OID = ?");
  
                pstmt.setRef(1, managerRef);
                ResultSet rs2 = pstmt.executeQuery();
                rs2.next();
                Struct manager = (Struct)rs2.getObject("MANAGER");
                Object[] manAttrs = manager.getAttributes();
      
                System.out.print(storeNo + "   ");
                System.out.print(
                    locAttrs[0] + " " +
                    locAttrs[1] + " " +
                    locAttrs[2] + ", " +
                    locAttrs[3] + " " +
                    locAttrs[4] + " ");

                for (int i = 0; i &lt; cofTypes.length; i++)
                    System.out.print( cofTypes[i] + " ");
          
                System.out.println(
                    manAttrs[1] + ", " +
                    manAttrs[2]);
        
                rs2.close();
                pstmt.close();
            }

            rs.close();

        } catch(BatchUpdateException b) {
            System.err.println("-----BatchUpdateException-----");
            System.err.println("SQLState:  " + b.getSQLState());
            System.err.println("Message:  " + b.getMessage());
            System.err.println("Vendor:  " + b.getErrorCode());
            System.err.print("Update counts:  ");
            int [] updateCounts = b.getUpdateCounts();

            for (int i = 0; i &lt; updateCounts.length; i++) {
                System.err.print(updateCounts[i] + "   ");
            }
            System.err.println("");

        } catch(SQLException ex) {
            System.err.println("SQLException: " + ex.getMessage());
            System.err.println("SQLState:  " + ex.getSQLState());
            System.err.println("Message:  " + ex.getMessage());
            System.err.println("Vendor:  " + ex.getErrorCode());
        } finally {
            if (stmt != null) { stmt.close(); }
                JDBCTutorialUtilities.closeConnection(con);
            }
        }
    }
}
</pre></div>


        </div>
        <div class="NavBit">
            <a target="_top" href="distinct.html">&laquo; Previous</a>
            &bull;
            <a target="_top" href="../TOC.html">Trail</a>
            &bull;
            <a target="_top" href="sqlcustommapping.html">Next &raquo;</a>
        </div>
    </div>
    
<hr class="clearfloat"/>

<div id="Footer">
<table width="100%" border="0" cellspacing="0" cellpadding="5" summary="">
<tr>
    <td>
         <p class="footertext"><a name="license_info">Your use of this</a> page and all the material on pages under &quot;The Java Tutorials&quot; banner 
         is subject to these <a href="../../information/cpyr.html">legal notices</a>.
         </p>
         <p class="footertext">Copyright &copy; 1995, 2015 Oracle and/or its affiliates. All rights reserved.</p>
    </td>
    
    <td align="right">
        <p class="footertext">Problems with the examples? Try <a target="_blank"
        href="../../information/run-examples.html">Compiling and Running
        the Examples: FAQs</a>.
        </p>
        <p class="footertext">
        Complaints? Compliments? Suggestions? <a target="_blank"
            href="https://docs.oracle.com/javase/feedback.html">Give
        us your feedback</a>.       
        </p>
    </td>
    
</tr>
</table>
  
</div>
    
    <div class="PrintHeaders">
        <b>Previous page:</b> Using DISTINCT Data Type
        <br /><b>Next page:</b> Using Customized Type Mappings
    </div>
</body>
</html> 
